# Общая информация

STACK: **`Django`**,  **`PostgreSQL`**,  **`Django REST Framework`**

Проект из себя представляет веб-приложение для кафетерия для управления заказами, дополненное поддержкой REST API. Приложение предоставляет возможность управлять кафетерием как с помощью веб-интерфейсов(html страниц), так и с помощью REST API.

## Запуск  
### Предварительные действия  
#### Переменные окружения  
Перед запуском приложения необходимо определить следующие переменные окружения:  
- **SECRET_KEY** - секретный ключ  
- **POSTGRES_DB** - название базы данных в PostgreSQL  
- **POSTGRES_USER** - имя пользователя, который имеет доступ к базе данных  
- **POSTGRES_PASSWORD** - пароль пользователя базы данных в PostgreSQL  
- **POSTGRES_HOST** - адрес работающей базы данных PostgreSQL  
- **DEBUG** - флаг включенной или выключенной отладки(1 или 0)
### Варианты запуска  
#### Обычный запуск  
Для обычного запуска достаточно ввести последовательность следующих команд в директории проекта:  
1. `pip install -r requirements.txt`  
2. `python manage.py makemigrations`  
3. `python manage.py migrate`  
4. `python manage.py runserver`  
#### Запуск через docker  
Для запуска через docker понадобится лишь создать в директории проекта файл переменных окружения **vars.env** и прописать там все необходимые переменные окружения.
Далее все запускается командой `docker-compose up` в директории проекта.
#### Создание блюд
Далее следует создать суперпользователя командой:
`python manage.py createsuperuser`
и с помощью админ панели по адресу `/admin` создать в базе данных записи с блюдами в разделе **Dishes**. Дальше можно пользоваться интерфейсом приложения.

## Тестирование
В проекте реализовано тестирование. Оно запускается командой `python manage.py test` при настроенных переменных окружения и выданной пользователю базы данных привилегии создавать базы данных.


# Веб-интерфейс  

## Вывод
### Как реализовано
Вывод заказов реализован через встроенный в Django шаблон классов представлений **ListView**. Из дополнений были реализованы только передача текущего статуса для инструментов фильтрации и фильтрация списка объектов по переданным представлению фильтрам. За отображение страницы вывода отвечает класс **OrdersListView** в файле **views.py**.
### Как пользоваться
Вывод заказов происходит на странице **Поиск заказов**. На этой странице реализовано 2 инструмента поиска: по фильтру и по номеру стола. Фильтры реализованы с использованием **GET** параметров.

## Добавление заказа
### Как реализовано
Добавление заказа было реализовано через встроенные в Django шаблон классов представлений **FormView** и шаблон классов форм **ModelForm**. Из дополнений были реализованы только передача текущего статуса для инструментов фильтрации и фильтрация списка объектов по переданным представлению фильтрам. Все было реализовано в рамках официальной документации **Django** без дополнений со стороны разработчика. За отображение страницы добавления заказа отвечает класс **CreateOrderView** в файле **views.py**. За отображение формы создания заказа отвечает класс **OrderCreateForm** в файле **forms.py**
### Как пользоваться
Добавление заказа реализовано через обычную форму на странице **Добавление заказа**, все как обычно.

## Расчёт выручки
### Как реализовано
Расчёт выручки реализован через простую функцию-представление **calc_cash** и функцию, предоставляющей API для Ajax запроса на странице подсчёта выручки **get_cash**
### Как пользоваться
Расчёт выручки выполняется на странице **Расчёт выручки**: достаточно просто выставить промежуток времени, за который надо подсчитать выручку.

## Редактирование заказа
### Как реализовано
#### Удаление заказа
Удаление заказа реализовано через простую функцию-представление **delete_order**, в которую через строку запроса передается идентификатор удаляемого заказа

#### Изменение деталей заказа
Изменение деталей заказа, подобно **Добавлению заказа**, реализовано через шаблон классов представлений **UpdateView** и шаблона классов формы **ModelForm**. Из дополнения в классе представления реализовано только задавание даты оплаты в зависимости от предыдущего статуса и изменение дефолтной формы для изменения объекта модели. В остальном поведение класса-представление стандартно.

### Как пользоваться
#### Удаление заказа
Удаление заказов выполняется через нажатие на клавишу **Удалить** справа от каждой записи о заказе.

#### Изменение деталей заказа
Редактирование заказа выполняется через страницу с формой редактирования заказа при нажатии на кнопку **Редактировать** справа от каждой записи о заказе.

# REST API

IN PROGRESS...
